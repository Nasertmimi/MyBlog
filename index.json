
[{"content":" Summary # Dog from Hackthebox.com is an easy level machine dealing with information disclosure, users enumeration, authenticated remote code execution, password reuse and finally abusing high priveleged binary to leak the root flag\nenumeration ok eventially i found that the website working on DropBack CMS. foot hold\nyou can see that we have a .git repository there so let\u0026rsquo;s dump it using git-dumper.\nso after analyzing the .git file i found a mysql credentials as shown below It took me sometime to figure out what to do with that password since i have no username, after some digging i stumbled across a vulnerability in the DropBack CMS that allows you to enumerate users so i wrote this python script to do so\nimport requests from sys import argv \u0026#39;\u0026#39;\u0026#39; users enum for dog machine \u0026#39;\u0026#39;\u0026#39; def user_enum(base_url,file): with open ( file , \u0026#39;r\u0026#39; ) as f: for line in f: line = line.strip() req= requests.get(f\u0026#39;{base_url}/?q=accounts/{line}\u0026#39;) if req.status_code==403: print(f\u0026#39;Valid username: {line}\u0026#39;) if __name__==\u0026#39;__main__\u0026#39;: if len(argv)\u0026lt;=1: print(f\u0026#39;{argv[0]} \u0026lt;url\u0026gt; \u0026lt;user_wordlist\u0026gt;\u0026#39;) exit() if argv[1]==\u0026#39;-h\u0026#39;: print(f\u0026#39;{argv[0]} \u0026lt;url\u0026gt; \u0026lt;user_wordlist\u0026gt;\u0026#39;) else: base_url=argv[1] user_enum(base_url,argv[2]) and through password spraying i got valid credentials.\nTo obtain a reverse shell: use this article Backdrop CMS 1.27.1 authenticated RCE (the shell content I used is pentestmonkey\u0026rsquo;s reverse shell)\nafter that you go to install a module manually page and upload your directory there notice: you have to provide .tar version of the exploit in order to get the shell. setup your listner and VOILA. remember to think out of the box, do you remember that we have a password earlier that we found in the .git directory try and use it on existing users now.\nuser flag: e20619b2ba354aa****************** Privilege escalation to obtain the root flag execute\nsudo -l there is this \u0026ldquo;bee\u0026rdquo; command you can see the help by executing\nsudo /usr/local/bin/bee --help and finely get root flag with\nsudo /usr/local/bin/bee dbim /root/root.txt -d --root=/var/www/html we have the dbim flag is to import a specific file to the database the -d is for debug so when the file import fails we can see it\u0026rsquo;s contents and finely the \u0026ndash;root flag is there to give the dropback directory.\n","externalUrl":null,"permalink":"/MyBlog/writeups/dog/","section":"Writeups","summary":"Summary # Dog from Hackthebox.","title":"Dog","type":"writeups"},{"content":"","externalUrl":null,"permalink":"/MyBlog/hackthebox/","section":"Hackthebox","summary":"","title":"Hackthebox","type":"hackthebox"},{"content":" ","externalUrl":null,"permalink":"/MyBlog/","section":"Home","summary":" ","title":"Home","type":"page"},{"content":"","externalUrl":null,"permalink":"/MyBlog/tryhackme/","section":"Tryhackme","summary":"","title":"Tryhackme","type":"tryhackme"},{"content":"","externalUrl":null,"permalink":"/MyBlog/writeups/","section":"Writeups","summary":"","title":"Writeups","type":"writeups"}]